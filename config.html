<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutomatUp - Config</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- Main Container -->
    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-900 text-white flex-shrink-0">
            <!-- Logo -->
            <div class="p-6 border-b border-gray-700">
                <img src="logo.png" alt="AutomatUp Logo" class="h-10 w-auto">
            </div>
            
            <!-- Navigation Menu -->
            <nav class="mt-6">
                <ul class="space-y-2 px-4">
                    <li>
                        <a href="dashboard.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition duration-200">
                            <i class="fas fa-th-large"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="analysis.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition duration-200">
                            <i class="fas fa-chart-bar"></i>
                            <span>Analytics</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition duration-200">
                            <i class="fas fa-file-alt"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                    <li>
                        <a href="event-log.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition duration-200">
                            <i class="fas fa-list-alt"></i>
                            <span>Event Log</span>
                        </a>
                    </li>
                    <li>
                        <a href="feed.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition duration-200">
                            <i class="fas fa-video"></i>
                            <span>Feed</span>
                        </a>
                    </li>
                    <li>
                        <a href="settings.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition duration-200">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                    <li>
                        <a href="config.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg bg-blue-600 text-white">
                            <i class="fas fa-sliders-h"></i>
                            <span>Config</span>
                        </a>
                    </li>
                    <li>
                        <a href="profile.html" class="flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition duration-200">
                            <i class="far fa-user"></i>
                            <span>Profile</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Bar -->
            <header class="bg-white shadow-sm border-b border-gray-200 px-6 py-4">
                <div class="flex items-center justify-between">
                    <!-- Search Bar -->
                    <div class="flex-1 max-w-md">
                        <div class="relative">
                            <input
                                type="text"
                                placeholder="Search"
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            />
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                    </div>
                    
                    <!-- Right Side Icons -->
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2 text-gray-600">
                            <i class="far fa-clock"></i>
                            <span class="text-sm" data-time>05:43pm</span>
                        </div>
                        <button class="text-gray-600 hover:text-gray-800">
                            <i class="far fa-bell"></i>
                        </button>
                        <button class="text-gray-600 hover:text-gray-800">
                            <i class="far fa-user"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="flex-1 overflow-auto p-6">
                <!-- Breadcrumb -->
                <nav class="mb-6">
                    <div class="flex items-center space-x-2 text-sm">
                        <a href="dashboard.html" class="text-gray-500 hover:text-gray-700">Dashboard</a>
                        <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
                        <span class="text-gray-700">Configuration</span>
                    </div>
                </nav>

                <!-- Page Header -->
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">System Configuration</h1>
                    <p class="text-gray-600 mt-2">Configure your automation settings and operational rules</p>
                </div>

                <form id="configForm" class="space-y-8">
                    <!-- Controls Section -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h2 class="text-xl font-semibold text-gray-900 mb-6">Control Settings</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Plan Selector -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Plan</label>
                                <select name="plan" id="planSelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="Basic">Basic</option>
                                    <option value="Advance">Advance</option>
                                    <option value="Pro">Pro</option>
                                </select>
                            </div>

                            <!-- Object Selector -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Object</label>
                                <select name="object" id="objectSelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="sack">Sack</option>
                                    <option value="vehicle">Vehicle</option>
                                    <option value="person">Person</option>
                                    <option value="equipment">Equipment</option>
                                </select>
                            </div>

                            <!-- Action Selector -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Action</label>
                                <select name="action" id="actionSelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="counting">Counting</option>
                                    <option value="tracking">Tracking</option>
                                    <option value="detection">Detection</option>
                                    <option value="monitoring">Monitoring</option>
                                </select>
                            </div>

                            <!-- Area Selector -->
                            <div class="md:col-span-3">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Area</label>
                                <select name="area" id="areaSelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="dock-1">Dock 1</option>
                                    <option value="dock-2">Dock 2</option>
                                    <option value="warehouse">Warehouse</option>
                                    <option value="loading-bay">Loading Bay</option>
                                    <option value="gate">Gate Area</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Rules Section -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h2 class="text-xl font-semibold text-gray-900 mb-6">Operational Rules</h2>
                        
                        <div class="space-y-6">
                            <!-- What to do -->
                            <div>
                                <label for="whatToDo" class="block text-sm font-medium text-gray-700 mb-2">
                                    What to do
                                    <span class="text-gray-500 font-normal">- Define the primary action or task</span>
                                </label>
                                <textarea 
                                    name="whatToDo" 
                                    id="whatToDo" 
                                    rows="3" 
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Describe what action should be performed..."
                                ></textarea>
                                <p class="text-xs text-gray-500 mt-1">Example: Count the number of sacks being loaded and unloaded</p>
                            </div>

                            <!-- Where to do -->
                            <div>
                                <label for="whereToDo" class="block text-sm font-medium text-gray-700 mb-2">
                                    Where to do
                                    <span class="text-gray-500 font-normal">- Specify the location or zone</span>
                                </label>
                                <textarea 
                                    name="whereToDo" 
                                    id="whereToDo" 
                                    rows="3" 
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Specify the location or area..."
                                ></textarea>
                                <p class="text-xs text-gray-500 mt-1">Example: At the designated loading docks and truck stations</p>
                            </div>

                            <!-- How to do -->
                            <div>
                                <label for="howToDo" class="block text-sm font-medium text-gray-700 mb-2">
                                    How to do
                                    <span class="text-gray-500 font-normal">- Detail the method or process</span>
                                </label>
                                <textarea 
                                    name="howToDo" 
                                    id="howToDo" 
                                    rows="3" 
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Describe the methodology or approach..."
                                ></textarea>
                                <p class="text-xs text-gray-500 mt-1">Example: Using computer vision to automatically detect and count objects in real-time</p>
                            </div>

                            <!-- When to do -->
                            <div>
                                <label for="whenToDo" class="block text-sm font-medium text-gray-700 mb-2">
                                    When to do
                                    <span class="text-gray-500 font-normal">- Define timing and conditions</span>
                                </label>
                                <textarea 
                                    name="whenToDo" 
                                    id="whenToDo" 
                                    rows="3" 
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Specify timing conditions and triggers..."
                                ></textarea>
                                <p class="text-xs text-gray-500 mt-1">Example: During operational hours when trucks are present and loading activities are detected</p>
                            </div>
                        </div>
                    </div>

                    <!-- Example Section -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h2 class="text-xl font-semibold text-gray-900 mb-4">Configuration Example</h2>
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <div class="flex items-start space-x-3">
                                <i class="fas fa-lightbulb text-yellow-500 mt-1"></i>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-2">Sample Configuration</h4>
                                    <p class="text-gray-700 text-sm leading-relaxed" id="exampleText">
                                        For night trucks these are two ROI where the truck will come and there are two stations corresponding to it. Do count loading and unloading of sacks.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex items-center justify-end space-x-4">
                        <button 
                            type="button" 
                            id="resetBtn"
                            class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition duration-200"
                        >
                            Reset
                        </button>
                        <button 
                            type="submit"
                            class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200"
                        >
                            Save Configuration
                        </button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script src="js/shared.js"></script>
    <script>
        // Config Page Logic
        class ConfigPage {
            constructor() {
                this.form = document.getElementById('configForm');
                this.resetBtn = document.getElementById('resetBtn');
                this.init();
            }

            init() {
                this.loadConfig();
                this.bindEvents();
            }

            loadConfig() {
                const config = window.appState.getConfig();
                
                // Load form values
                document.getElementById('planSelect').value = config.plan;
                document.getElementById('objectSelect').value = config.object;
                document.getElementById('actionSelect').value = config.action;
                document.getElementById('areaSelect').value = config.area;
                
                // Load rules
                document.getElementById('whatToDo').value = config.rules.whatToDo;
                document.getElementById('whereToDo').value = config.rules.whereToDo;
                document.getElementById('howToDo').value = config.rules.howToDo;
                document.getElementById('whenToDo').value = config.rules.whenToDo;
                
                // Load example text
                document.getElementById('exampleText').textContent = config.exampleText;
            }

            bindEvents() {
                this.form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveConfig();
                });

                this.resetBtn.addEventListener('click', () => {
                    this.resetConfig();
                });
            }

            saveConfig() {
                const formData = new FormData(this.form);
                const config = {
                    plan: formData.get('plan'),
                    object: formData.get('object'),
                    action: formData.get('action'),
                    area: formData.get('area'),
                    rules: {
                        whatToDo: formData.get('whatToDo'),
                        whereToDo: formData.get('whereToDo'),
                        howToDo: formData.get('howToDo'),
                        whenToDo: formData.get('whenToDo')
                    }
                };

                window.appState.updateConfig(config);
                window.utils.showToast('Configuration saved successfully!', 'success');
            }

            resetConfig() {
                if (confirm('Are you sure you want to reset all configuration settings?')) {
                    // Reset to defaults
                    const defaultConfig = {
                        plan: 'Basic',
                        object: 'sack',
                        action: 'counting',
                        area: 'dock-1',
                        rules: {
                            whatToDo: '',
                            whereToDo: '',
                            howToDo: '',
                            whenToDo: ''
                        }
                    };
                    
                    window.appState.updateConfig(defaultConfig);
                    this.loadConfig();
                    window.utils.showToast('Configuration reset to defaults', 'info');
                }
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            new ConfigPage();
        });
    </script>
</body>
</html>
